define("@widget/CONTACT/bs-genericMap-446fef84.js",["exports","~/c/bs-_rollupPluginBabelHelpers","~/c/bs-data-aids","@wsb/guac-widget-shared@^1/lib/common/utils/form"],(function(e,t,o,a){"use strict";const s=e=>`//img1.wsimg.com/isteam/ip/static/${e}`,r="undefined"==typeof window,l="IEMobile",n="Android",i="BlackBerry",c="iPhone|iPad|iPod",p=function(){return!r&&(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[n,i,c,l]).reduce(((e,t)=>e||new RegExp(`/${t}/i`).test(navigator.userAgent)),!1)},g=e=>{const t=`http://maps.google.com/maps?daddr=${e}`;window.open(t)},d=p,u=()=>p([c]),{Z_INDEX_FULL_SCREEN_OVERLAY:b}=(global.Core||guac["@wsb/guac-widget-core"]).constants.layers;class m extends(global.React||guac.react).Component{constructor(){super(...arguments),this.el=document.createElement("div"),this.el.className="x",this.mapContainer=null}componentDidMount(){const{renderMap:e}=this.props,t=document.querySelector(".device-chrome.device-chrome-mobile .viewport");Object.assign(this.el.style,{backgroundColor:"#ffffff",zIndex:b},t?{position:"absolute",left:t.style.left,right:t.style.right,top:t.style.top,bottom:t.style.bottom,width:t.style.width,height:t.style.height}:{position:"fixed",left:0,right:0,top:0,bottom:0,width:"100%",height:"100%"}),this.parentContainer=t?t.parentNode:document.body,this.parentContainer.appendChild(this.el),e(this.mapContainer)}componentWillUnmount(){this.parentContainer.removeChild(this.el)}render(){const{handleClose:e,getDirectionsLabel:t,handleGetDirections:a}=this.props,r=(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{category:"neutral",section:"overlay",style:{width:"100%",height:"100%"},"data-aid":o.D.CONTACT_MAP_MOBILE_OVERLAY},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Link,{tag:"a",style:{position:"absolute",right:"small",top:"small",cursor:"pointer",background:`url('${s("mapIcon/close.svg")}')`,zIndex:1,width:"34px",height:"34px"},onClick:e}),(global.React||guac.react).createElement("div",{ref:e=>{this.mapContainer=e},style:{width:"100%",height:"100%"}}),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Button.Primary,{style:{zIndex:1,position:"absolute",bottom:"xlarger",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",width:"90%"},onClick:a,children:t,solid:!0}));return(global.ReactDOM||guac["react-dom"]).createPortal(r,this.el)}}t._(m,"propTypes",{renderMap:(global.PropTypes||guac["prop-types"]).func.isRequired,handleClose:(global.PropTypes||guac["prop-types"]).func.isRequired,handleGetDirections:(global.PropTypes||guac["prop-types"]).func.isRequired,getDirectionsLabel:(global.PropTypes||guac["prop-types"]).string.isRequired,container:(global.PropTypes||guac["prop-types"]).node.isRequired});const h=e=>{let{lat:t,lon:o}=e;return{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[o,t]}}]}},y=e=>{let{map:t,lat:o,lon:a,isMapbox:s=!0}=e;const r=s?()=>{t.resize(),t.easeTo({center:[a,o]}),t.getSource("markers").setData(h({lat:o,lon:a}))}:()=>{t.panTo({lat:parseFloat(o,10),lng:parseFloat(a,10)})};(s?t.loaded():t&&!!t.mapUrl)?setTimeout(r,200):s&&t.on("load",r)},w=e=>{const t=u()?`http://maps.apple.com/?q=${e}`:`http://www.google.com/maps/dir//${e}`;window.location.href=t},v=e=>{if(window.google&&window.google.maps&&"function"==typeof e)return e();if(document.querySelectorAll("script[src*='maps.googleapis.com/maps/api/js']").length)return setTimeout(e,2e3);const t=document.createElement("script"),o=["https://maps.googleapis.com/maps/api/js","?client=gme-godaddycom","&channel=gc-widget-contact"].join("");t.setAttribute("src",`${o}`),t.setAttribute("async","async"),document.body.appendChild(t),t.onload=e};class C extends(global.React||guac.react).Component{render(){const{address:e,staticContent:t,isRouteMobilePreviewPublish:a,openFullScreenOverlay:s}=this.props,r={button:{position:"absolute",left:"xxlarge",top:"xsmall",width:"auto","@xs-only":{fontSize:"xsmall",left:"xsmall",maxWidth:"90%"}}};if(!a){const o=t.mapCTA,a=(0,(global.Core||guac["@wsb/guac-widget-core"]).UX2.utils.TCCLUtils.getTCCLString)({eid:"ux2.contact.get_directions.click",type:"click"});return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Button.Primary,{tag:"button","data-tccl":a,onClick:g.bind(null,e),style:r.button,solid:!0,icon:"direction",size:"small"},o)}return(global.React||guac.react).createElement("a",{onClick:s,style:r.icon,"data-aid":o.D.CONTACT_MAP_EXPAND_ICON})}}C.propTypes={address:(global.PropTypes||guac["prop-types"]).string,isRouteMobilePreviewPublish:(global.PropTypes||guac["prop-types"]).bool,staticContent:(global.PropTypes||guac["prop-types"]).object.isRequired,openFullScreenOverlay:(global.PropTypes||guac["prop-types"]).func.isRequired};const M={mapboxAccessToken:"pk.eyJ1IjoiZ29kYWRkeSIsImEiOiJjaWc5b20wcjcwczAydGFsdGxvamdvYnV0In0.JK9HuO6nAzc8BnMv6W7NBQ",mapboxStyleUrl:"mapbox://styles/godaddy/ciovyeygh0029atm6zbntgxk2"};var T={local:Object.assign({formSubmitHost:"http://contact.apps-api.instantpage.dev-secureserver.net:8400",generateUrlHost:"http://url-generator.apps.dev-secureserver.net:8080",contactsHost:"https://contacts.dev-godaddy.com"},M),development:Object.assign({formSubmitHost:"https://contact.apps-api.instantpage.dev-secureserver.net",generateUrlHost:"https://url-generator.apps.dev-secureserver.net",contactsHost:"https://contacts.dev-godaddy.com"},M),test:Object.assign({formSubmitHost:"https://contact.apps-api.instantpage.test-secureserver.net",generateUrlHost:"https://url-generator.apps.test-secureserver.net",contactsHost:"https://contacts.test-godaddy.com"},M),production:Object.assign({formSubmitHost:"https://contact.apps-api.instantpage.secureserver.net",generateUrlHost:"https://url-generator.apps.secureserver.net",contactsHost:"https://contacts.godaddy.com"},M)};const{GOOGLE_MAP_STATIC:P}=o.D;class E extends(global.React||guac.react).Component{constructor(e){super(e),this.state={staticUrl:""}}componentDidMount(){const{lat:e,lon:t,address:o}=this.props;(e&&t||o)&&this.generateUrl()}generateStyles(){return{width:"100%",height:"100%","@xs-only":{objectFit:"contain",position:"absolute"}}}generateUrl(){const{lat:e,lon:t,address:o,dimensions:a,env:s}=this.props,{height:r,width:l}=a,n=(T&&T[s]||{}).generateUrlHost;if(!n)return;const i=[`lat=${e}`,`&lon=${t}`,`&address=${o}`,`&height=${r}`,`&width=${l}`].join("");window.fetch(`${n}/v1/static-google-map?${i}`).then((e=>e.json())).then((e=>{let{url:t}=e;return this.setState({staticUrl:t})}))}render(){const{staticUrl:e}=this.state;return e?(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Image,{"data-aid":P,style:this.generateStyles(),src:e}):null}}E.propTypes={lat:(global.PropTypes||guac["prop-types"]).number,lon:(global.PropTypes||guac["prop-types"]).number,address:(global.PropTypes||guac["prop-types"]).string,dimensions:(global.PropTypes||guac["prop-types"]).object,env:(global.PropTypes||guac["prop-types"]).string},E.defaultProps={dimensions:{height:80,width:275}};class f extends(global.React||guac.react).Component{render(){const e={left:0,top:0,right:0,bottom:0,position:"absolute",display:"block",backgroundImage:`url('${s("mapIcon/mboxThumb.png")}')`,backgroundSize:"cover",backgroundPosition:"center"};return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{"data-aid":o.D.CONTACT_MAP_STATIC_REND,style:e,"data-traffic2":"pandc.vnext.edit_widget_contact.static_map.click"})}}class R extends(global.React||guac.react).Component{constructor(e){super(e),t._(this,"toggleMobileOverlay",(()=>{this.setState({showMobileOverlay:!this.state.showMobileOverlay})})),t._(this,"handleGetDirections",(()=>{const{address:e}=this.props;w(e)})),t._(this,"renderFullScreenMap",(e=>{this.generateGMap(e,!0)})),this.state={isMobile:d(),isViewPortRender:"MOBILE_RENDER_DEVICE"===e.viewDevice&&!!document.querySelector(".device-chrome"),showMobileOverlay:!1},this.generateGMap=this.generateGMap.bind(this),this.googleMap=null,this.mapContainer=null,this.currentCoords={lastLat:null,lastLon:null}}componentDidMount(){v(!this.state.isMobile&&this.generateGMap.bind(this,this.mapContainer,!1))}componentDidUpdate(e){const{lat:t,lon:o,address:a,isEditMode:s}=this.props,{isMobile:r}=this.state,{lastLat:l,lastLon:n}=this.currentCoords;t&&o&&l!==t&&n!==o&&(y({map:this.googleMap,lat:t,lon:o,isMapbox:!1}),this.currentCoords={lastLat:t,lastLon:o}),e.address===a&&(s||r)||this.generateGMap(this.mapContainer)}generateGMap(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{lat:o,lon:a,zoom:s,isEditMode:r,viewDevice:l,isPublishMode:n}=this.props,{isMobile:i,isViewPortRender:c}=this.state;if(!o||!a||!window.google)return;const p={lat:parseFloat(o,10),lng:parseFloat(a,10)},g={center:p,zoom:s,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,scrollwheel:!1,fullscreenControl:!1,streetViewControl:!1,zoomControl:(t||!i||r||"DESKTOP_RENDER_DEVICE"===l)&&!c,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_TOP}};i&&!t&&(g.gestureHandling="none"),this.googleMap=new google.maps.Map(e,g),new google.maps.Marker({position:p,map:this.googleMap})}render(){const{lat:e,lon:t,zoom:a,category:s,section:r,address:l,staticContent:n,renderMode:i,isPublishMode:c,viewDevice:p,isEditMode:g,overrideOverlay:d,env:u}=this.props,{isMobile:b,isViewPortRender:h,showMobileOverlay:y}=this.state;if(!Boolean(Number(e)&&Number(t)&&Number(a)))return null;const w={shared:{left:0,top:0,right:0,bottom:0,position:"absolute",transform:"translate3d(0,0,0)"},wrapper:{display:"block",cursor:"pointer",position:"absolute !important"}},v=d||b&&!g&&"DESKTOP_RENDER_DEVICE"!==p,M=v&&!h?this.toggleMobileOverlay:(global._||guac.lodash).noop,T={address:l,staticContent:n,isRouteMobilePreviewPublish:v,openFullScreenOverlay:M};return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{category:s,section:r,style:{...w.shared,...w.wrapper}},(global.React||guac.react).createElement("div",{ref:e=>{this.mapContainer=e},style:w.shared,"data-aid":o.D.CONTACT_MAP_REND,onClick:M},v&&(global.React||guac.react).createElement(E,this.props)),!h&&(global.React||guac.react).createElement(C,T),y&&(global.React||guac.react).createElement(m,{getDirectionsLabel:n.mapCTA,renderMap:this.renderFullScreenMap,handleClose:this.toggleMobileOverlay,handleGetDirections:this.handleGetDirections}))}}R.propTypes={lat:(global.PropTypes||guac["prop-types"]).string,lon:(global.PropTypes||guac["prop-types"]).string,zoom:(global.PropTypes||guac["prop-types"]).number,address:(global.PropTypes||guac["prop-types"]).string,env:(global.PropTypes||guac["prop-types"]).string,category:(global.PropTypes||guac["prop-types"]).string,section:(global.PropTypes||guac["prop-types"]).string,staticContent:(global.PropTypes||guac["prop-types"]).object.isRequired,isPublishMode:(global.PropTypes||guac["prop-types"]).bool,viewDevice:(global.PropTypes||guac["prop-types"]).string,isEditMode:(global.PropTypes||guac["prop-types"]).bool,overrideOverlay:(global.PropTypes||guac["prop-types"]).bool,renderMode:(global.PropTypes||guac["prop-types"]).string},R.defaultProps={staticContent:{mapCTA:""}};const x=e=>{if(window&&window.mapboxgl)return void e();window&&window._trfq&&window._trfq.push(["cmdLogEvent","load","ux2.contact.mapbox.load",[]]);const t="//api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl",o=document.createElement("script");o.setAttribute("src",`${t}.js`),o.setAttribute("type","text/javascript"),o.setAttribute("async","async"),o.setAttribute("crossorigin","anonymous"),document.head.appendChild(o),o.onload=()=>{const o=document.createElement("link");o.setAttribute("href",`${t}.css`),o.setAttribute("rel","stylesheet"),o.setAttribute("async","async"),document.head.appendChild(o),o.onload=e}},D=e=>{let{containerId:t,interactive:o,scrollZoom:a,lat:s,lon:r,zoom:l,accessToken:n,styleUrl:i}=e;const c=window.mapboxgl;if(!c||!c.supported())return null;const p={container:document.getElementById(t),style:i,interactive:o,zoom:l,center:[r,s],minZoom:1.5};c.accessToken=n;const g=new c.Map(p);return a||g.scrollZoom.disable(),g.on("load",(()=>{const e={id:"markers",type:"symbol",source:{type:"geojson"},layout:{"icon-image":"marker-vnext","icon-size":1}};if(e.source.data=h({lat:s,lon:r}),g.addLayer(e),o){const e=new c.NavigationControl;g.addControl(e,"top-right")}})),g};class O extends(global.React||guac.react).Component{constructor(e){super(e),t._(this,"toggleMobileOverlay",(()=>{this.setState({showMobileOverlay:!this.state.showMobileOverlay})})),t._(this,"generateMap",(()=>{const{lat:e,lon:t,zoom:o,viewDevice:a,mapboxAccessToken:s,mapboxStyleUrl:r,renderMode:l}=this.props,n=a&&a.match(/mobile/i)||l===(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.PUBLISH&&d();e&&t&&(this.glMap=D({containerId:this.mapId,interactive:!this.state.isRouteMobilePreviewPublish&&!n,scrollZoom:!1,lat:e,lon:t,zoom:o,accessToken:s,styleUrl:r}))})),t._(this,"renderFullScreenMap",(e=>{const{lat:t,lon:o,zoom:a,mapboxAccessToken:s,mapboxStyleUrl:r}=this.props;D({container:e,interactive:!0,lat:t,lon:o,zoom:a,scrollZoom:!0,accessToken:s,styleUrl:r})})),t._(this,"handleGetDirections",(()=>{const{address:e}=this.props;w(e)})),this.state={isMobile:d(),isViewPortRender:"MOBILE_RENDER_DEVICE"===e.viewDevice&&!!document.querySelector(".device-chrome"),showMobileOverlay:!1},this.glMap=null,this.mapId=(global._||guac.lodash).uniqueId("MapBox-")}componentDidMount(){x(this.generateMap)}componentWillUnmount(){this.glMap?.remove()}componentDidUpdate(e){if(!this.glMap)return void x(this.generateMap);const{lat:t,lon:o}=this.props;t&&o&&(t!==e.lat||o!==e.lon)&&y({map:this.glMap,lat:t,lon:o})}render(){const{lat:e,lon:t,zoom:a,address:s,staticContent:r,isPublishMode:l,isEditMode:n,viewDevice:i,overrideOverlay:c,renderMode:p}=this.props;if(!(Number(e)&&Number(t)&&Number(a)))return null;const{showMobileOverlay:g,isViewPortRender:d,isMobile:u}=this.state,b=c||u&&!n&&"DESKTOP_RENDER_DEVICE"!==i||l&&u,h=b&&!d?this.toggleMobileOverlay:(global._||guac.lodash).noop,y={address:s,staticContent:r,isRouteMobilePreviewPublish:b,openFullScreenOverlay:h};return(global.React||guac.react).createElement((global.React||guac.react).Fragment,null,(global.React||guac.react).createElement("div",{id:this.mapId,style:{left:0,top:0,right:0,bottom:0,position:"absolute",cursor:"pointer",display:"block",transform:"translate3d(0,0,0)"},"data-aid":o.D.CONTACT_MAP_REND,onClick:h}),p!==(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.PUBLISH&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX.Style,{shared:!0},".mapboxgl-canvas { height: 100% !important; width: 100% !important; }"),(global.React||guac.react).createElement(C,y),g&&(global.React||guac.react).createElement(m,{getDirectionsLabel:r.mapCTA,renderMap:this.renderFullScreenMap,handleClose:this.toggleMobileOverlay,handleGetDirections:this.handleGetDirections}))}}O.propTypes={lat:(global.PropTypes||guac["prop-types"]).string,lon:(global.PropTypes||guac["prop-types"]).string,zoom:(global.PropTypes||guac["prop-types"]).number,viewDevice:(global.PropTypes||guac["prop-types"]).string,address:(global.PropTypes||guac["prop-types"]).string,env:(global.PropTypes||guac["prop-types"]).string,mapboxAccessToken:(global.PropTypes||guac["prop-types"]).string,mapboxStyleUrl:(global.PropTypes||guac["prop-types"]).string,staticContent:(global.PropTypes||guac["prop-types"]).object.isRequired,isPublishMode:(global.PropTypes||guac["prop-types"]).bool,isEditMode:(global.PropTypes||guac["prop-types"]).bool,overrideOverlay:(global.PropTypes||guac["prop-types"]).bool,renderMode:(global.PropTypes||guac["prop-types"]).string},O.defaultProps={staticContent:{mapCTA:""}};var _="mapbox",A="google",k="static";class S extends(global.React||guac.react).Component{render(){const{type:e}=this.props;switch(e){case k:return(global.React||guac.react).createElement(f,null);case _:return(global.React||guac.react).createElement(O,this.props);case A:return(global.React||guac.react).createElement(R,this.props);default:return null}}}S.propTypes={type:(global.PropTypes||guac["prop-types"]).string,...R.propTypes,...O.propTypes},e.default=S,Object.defineProperty(e,"__esModule",{value:!0})})),"undefined"!=typeof window&&(window.global=window);
//# sourceMappingURL=bs-genericMap-446fef84.js.map
